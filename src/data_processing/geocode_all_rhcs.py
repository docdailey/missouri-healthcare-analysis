#!/usr/bin/env python3
"""
Geocode all 316 Missouri RHCs using free APIs
Uses Census Geocoder and Nominatim (OpenStreetMap) as fallback
"""

import pandas as pd
import requests
import json
from pathlib import Path
from datetime import datetime
import time
import numpy as np
from typing import Tuple, Optional
import logging

# Setup logging
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

class RHCGeocoder:
    """Geocode all Missouri RHCs using free APIs"""
    
    def __init__(self):
        self.base_dir = Path("/Volumes/My4TBDrive/supply_chain_analysis/healthcare")
        self.data_dir = self.base_dir / "data"
        self.output_dir = self.data_dir / "operational"
        self.output_dir.mkdir(parents=True, exist_ok=True)
        
        # Load RHC data
        self.rhc_file = self.data_dir / "cms" / "missouri_rhc_enrollments.csv"
        self.rhcs = None
        
        # Geocoding stats
        self.stats = {
            'total': 0,
            'census_success': 0,
            'nominatim_success': 0,
            'city_fallback': 0,
            'failed': 0
        }
        
        # Missouri city coordinates (fallback)
        self.city_coords = {
            'SIKESTON': (36.8767, -89.5878),
            'POPLAR BLUFF': (36.7570, -90.3929),
            'CAPE GIRARDEAU': (37.3058, -89.5181),
            'MOUNTAIN GROVE': (37.1306, -92.2633),
            'DEXTER': (36.7959, -89.9578),
            'BOLIVAR': (37.6147, -93.4105),
            'BRANSON': (36.6437, -93.2185),
            'BRANSON WEST': (36.6437, -93.3185),
            'COLUMBIA': (38.9517, -92.3341),
            'JEFFERSON CITY': (38.5767, -92.1735),
            'SPRINGFIELD': (37.2090, -93.2923),
            'KANSAS CITY': (39.0997, -94.5786),
            'ST LOUIS': (38.6270, -90.1994),
            'SAINT LOUIS': (38.6270, -90.1994),
            'HANNIBAL': (39.7083, -91.3585),
            'JOPLIN': (37.0842, -94.5133),
            'WEST PLAINS': (36.7282, -91.8524),
            'KIRKSVILLE': (40.1948, -92.5833),
            'NEVADA': (37.8392, -94.3547),
            'CLINTON': (38.3686, -93.7783),
            'ROLLA': (37.9514, -91.7715),
            'LEBANON': (37.6806, -92.6638),
            'SEDALIA': (38.7045, -93.2283),
            'WARRENSBURG': (38.7628, -93.7360),
            'MARSHALL': (39.1231, -93.1969),
            'FULTON': (38.8467, -91.9480),
            'MEXICO': (39.1698, -91.8828),
            'MOBERLY': (39.4184, -92.4382),
            'CHILLICOTHE': (39.7953, -93.5524),
            'MACON': (39.7423, -92.4726),
            'BETHANY': (40.2678, -94.0283),
            'TRENTON': (40.0786, -93.6166),
            'CAMERON': (39.7403, -94.2402),
            'RICHMOND': (39.2786, -93.9769),
            'LEXINGTON': (39.1847, -93.8799),
            'INDEPENDENCE': (39.0911, -94.4155),
            'BLUE SPRINGS': (39.0170, -94.2816),
            'LEES SUMMIT': (38.9108, -94.3822),
            "LEE'S SUMMIT": (38.9108, -94.3822),
            'BELTON': (38.8108, -94.5319),
            'HARRISONVILLE': (38.6533, -94.3488),
            'BUTLER': (38.2586, -94.3305),
            'ELDON': (38.3483, -92.5816),
            'CAMDENTON': (38.0081, -92.7446),
            'OSAGE BEACH': (38.1506, -92.6177),
            'WARSAW': (38.2431, -93.3816),
            'WINDSOR': (38.5322, -93.5222),
            'VERSAILLES': (38.4314, -92.8410),
            'CALIFORNIA': (38.6276, -92.5663),
            'TIPTON': (38.6556, -92.7799),
            'BOONVILLE': (38.9736, -92.7432),
            'FAYETTE': (39.1459, -92.6838),
            'GLASGOW': (39.2270, -92.8466),
            'CARROLLTON': (39.3581, -93.4958),
            'BOWLING GREEN': (39.3419, -91.1949),
            'LOUISIANA': (39.4486, -91.0515),
            'HANNIBAL': (39.7083, -91.3585),
            'PALMYRA': (39.7945, -91.5233),
            'CANTON': (40.1409, -91.5099),
            'KAHOKA': (40.4203, -91.7190),
            'MEMPHIS': (40.4581, -92.1713),
            'LANCASTER': (40.5208, -92.5288),
            'MILAN': (40.2019, -93.1252),
            'UNIONVILLE': (40.4764, -92.9941),
            'PRINCETON': (40.4006, -93.5808),
            'MAYSVILLE': (39.8892, -94.3619),
            'ALBANY': (40.2486, -94.3308),
            'STANBERRY': (40.2178, -94.5386),
            'MARYVILLE': (40.3461, -94.8725),
            'ROCK PORT': (40.4103, -95.5169),
            'TARKIO': (40.4394, -95.3783),
            'FAIRFAX': (40.3397, -95.3933),
            'SAVANNAH': (39.9419, -94.8305),
            'OREGON': (39.9867, -95.1450),
            'MOUND CITY': (40.1311, -95.2322),
            'CRAIG': (40.2619, -95.3708),
            'KING CITY': (40.0514, -94.5258),
            'GRANT CITY': (40.4839, -94.4122),
            'MOUNT VERNON': (37.1037, -93.8185),
            'MONETT': (36.9289, -93.9277),
            'AURORA': (36.9706, -93.7180),
            'CASSVILLE': (36.6770, -93.8688),
            'NEOSHO': (36.8690, -94.3680),
            'SENECA': (36.8342, -94.6113),
            'CARTHAGE': (37.1764, -94.3102),
            'WEBB CITY': (37.1465, -94.4630),
            'CARL JUNCTION': (37.1767, -94.5655),
            'LAMAR': (37.4948, -94.2766),
            'GREENFIELD': (37.4136, -93.8408),
            'LOCKWOOD': (37.3856, -93.9547),
            'STOCKTON': (37.6989, -93.7955),
            'HUMANSVILLE': (37.7945, -93.5788),
            'FAIR PLAY': (37.6217, -93.5816),
            'BUFFALO': (37.6439, -93.0924),
            'HERMITAGE': (37.9414, -93.3166),
            'WHEATLAND': (37.9550, -93.4044),
            'PRESTON': (37.9556, -93.1977),
            'URBANA': (37.8453, -93.1688),
            'LOUISBURG': (37.6792, -92.8582),
            'CONWAY': (37.5003, -92.7918),
            'MARSHFIELD': (37.3389, -92.9071),
            'STRAFFORD': (37.2684, -93.1185),
            'WILLARD': (37.3053, -93.4288),
            'REPUBLIC': (37.1200, -93.4802),
            'CLEVER': (37.0303, -93.4733),
            'BILLINGS': (37.0675, -93.5521),
            'NIXA': (37.0434, -93.2952),
            'OZARK': (37.0211, -93.2060),
            'HIGHLANDVILLE': (36.9334, -93.2810),
            'SPARTA': (37.0017, -93.0632),
            'FORSYTH': (36.6831, -93.1188),
            'HOLLISTER': (36.6211, -93.2155),
            'KIMBERLING CITY': (36.6334, -93.4163),
            'SHELL KNOB': (36.6389, -93.6343),
            'REEDS SPRING': (36.7506, -93.3783),
            'GALENA': (36.8045, -93.4663),
            'CRANE': (36.9034, -93.5713),
            'PIERCE CITY': (36.9459, -94.0019),
            'SARCOXIE': (37.0690, -94.1166),
            'DIAMOND': (37.1590, -94.3208),
            'GRANBY': (36.9170, -94.2552),
            'ANDERSON': (36.6506, -94.4433),
            'PINEVILLE': (36.5945, -94.3844),
            'NOEL': (36.5459, -94.4852),
            'SOUTHWEST CITY': (36.5140, -94.6097),
            'GOODMAN': (36.7434, -94.3988),
            'STELLA': (36.7609, -94.1877),
            'ROCKY COMFORT': (36.7209, -94.1577),
            'LANAGAN': (36.6081, -94.4477),
            'SOUTH WEST CITY': (36.5140, -94.6097),
            'WHEATON': (36.7600, -94.0574),
            'PURDY': (36.8184, -93.9208),
            'EXETER': (36.6723, -93.9388),
            'BUTTERFIELD': (36.7500, -93.9013),
            'WASHBURN': (36.5870, -93.9658),
            'SELIGMAN': (36.5220, -93.9380),
            'EAGLE ROCK': (36.5581, -93.7530),
            'GOLDEN': (36.5253, -93.6377),
            'ROGERSVILLE': (37.1170, -93.0560),
            'AVA': (36.9520, -92.6604),
            'GAINESVILLE': (36.6023, -92.4282),
            'THEODOSIA': (36.5895, -92.6613),
            'MOUNTAIN VIEW': (36.9953, -91.7038),
            'WILLOW SPRINGS': (36.9923, -91.9698),
            'CABOOL': (37.1245, -92.1010),
            'HOUSTON': (37.3261, -91.9599),
            'LICKING': (37.4989, -91.8571),
            'SALEM': (37.6456, -91.5360),
            'BUNKER': (37.4564, -91.2293),
            'ELLINGTON': (36.9300, -90.9693),
            'VAN BUREN': (36.9912, -91.0146),
            'EMINENCE': (37.1506, -91.3579),
            'SUMMERSVILLE': (37.1789, -91.6574),
            'WINONA': (37.0098, -91.3232),
            'BIRCH TREE': (36.9912, -91.4932),
            'ALTON': (36.6942, -91.3993),
            'THAYER': (36.5245, -91.5432),
            'MAMMOTH SPRING': (36.4934, -91.5346),
            'KOSHKONONG': (36.5981, -91.6354),
            'BRANDSVILLE': (36.6531, -91.7215),
            'PEACE VALLEY': (36.8400, -91.6921),
            'POMONA': (36.8728, -91.9029),
            'POTTERSVILLE': (36.7117, -92.0807),
            'DRURY': (36.9159, -92.3185),
            'VANZANT': (36.9867, -92.2407),
            'NORWOOD': (37.1142, -92.4074),
            'MACOMB': (37.1292, -92.4693),
            'MANSFIELD': (37.1067, -92.5807),
            'HARTVILLE': (37.2511, -92.5104),
            'SEYMOUR': (37.1464, -92.7688),
            'DIGGINS': (37.1711, -92.8488),
            'FORDLAND': (37.1600, -92.9413),
            'ROACH': (38.1300, -92.8021),
            'GRAVOIS MILLS': (38.2333, -92.8249),
            'CLIMAX SPRINGS': (38.1333, -93.0333),
            'MACKS CREEK': (37.9658, -92.9688),
            'MONTREAL': (38.0000, -92.5688),
            'LINN CREEK': (38.0167, -92.7021),
            'KAISER': (38.1333, -92.6021),
            'LAKE OZARK': (38.1989, -92.6388),
            'SUNRISE BEACH': (38.1833, -92.7438),
            'LAURIE': (38.1972, -92.8338),
            'ROCKY MOUNT': (38.2750, -92.6821),
            'EUGENE': (38.3522, -92.4135),
            'HENLEY': (38.3531, -92.3299),
            'SAINT ELIZABETH': (38.2619, -92.2674),
            'SAINT THOMAS': (38.3692, -92.2202),
            'META': (38.3100, -92.1677),
            'WESTPHALIA': (38.4425, -91.9963),
            'KOELTZTOWN': (38.4419, -92.0410),
            'FREEBURG': (38.3197, -91.9338),
            'ARGYLE': (38.2947, -91.8983),
            'VIENNA': (38.1867, -91.9471),
            'BRINKTOWN': (38.2231, -91.7316),
            'SAINT JAMES': (38.0042, -91.6149),
            'CUBA': (38.0628, -91.4032),
            'STEELVILLE': (37.9681, -91.3549),
            'LEASBURG': (37.9478, -91.2974),
            'BOURBON': (38.1550, -91.2493),
            'SULLIVAN': (38.2081, -91.1604),
            'SAINT CLAIR': (38.3461, -90.9774),
            'UNION': (38.4500, -91.0082),
            'WASHINGTON': (38.5581, -91.0121),
            'NEW HAVEN': (38.6081, -91.2190),
            'GERALD': (38.4017, -91.3299),
            'ROSEBUD': (38.3869, -91.4010),
            'OWENSVILLE': (38.3456, -91.5015),
            'BLAND': (38.3022, -91.6321),
            'BELLE': (38.2861, -91.7210),
            'DIXON': (37.9917, -92.0938),
            'CROCKER': (37.9489, -92.2638),
            'RICHLAND': (37.8567, -92.4043),
            'WAYNESVILLE': (37.8286, -92.2007),
            'SAINT ROBERT': (37.8281, -92.1777),
            'FORT LEONARD WOOD': (37.7606, -92.1407),
            'DEVILS ELBOW': (37.8275, -92.0871),
            'DUKE': (37.8358, -91.9899),
            'JEROME': (37.9286, -91.9774),
            'NEWBURG': (37.9117, -91.9032),
            'EDGAR SPRINGS': (37.7050, -91.8671),
            'LENOX': (37.5667, -91.8893),
            'BEULAH': (37.6331, -91.9232),
            'VICHY': (38.0933, -91.7635),
            'VIENNA': (38.1867, -91.9471),
            'BOSS': (37.6431, -91.2521),
            'BIXBY': (37.5300, -91.1093),
            'GLADDEN': (37.4817, -91.1454),
            'JADWIN': (37.4192, -91.5488),
            'MONTAUK': (37.3800, -91.6707),
            'LESTERVILLE': (37.4528, -90.8293),
            'BLACK': (37.5328, -90.9593),
            'CENTERVILLE': (37.4328, -90.9576),
            'ELLINGTON': (36.9300, -90.9693),
            'REDFORD': (37.3006, -90.8682),
            'ANNAPOLIS': (37.3622, -90.6990),
            'VULCAN': (37.3294, -90.6729),
            'MIDDLE BROOK': (37.2533, -90.6062),
            'IRONTON': (37.5973, -90.6276),
            'ARCADIA': (37.5881, -90.6265),
            'PILOT KNOB': (37.6242, -90.6448),
            'BELLEVIEW': (37.6811, -90.7404),
            'CALEDONIA': (37.7647, -90.7732),
            'POTOSI': (37.9367, -90.7879),
            'MINERAL POINT': (37.9494, -90.7276),
            'Belgrade': (37.7869, -90.8504),
            'BISMARCK': (37.7694, -90.6248),
            'LEADWOOD': (37.8611, -90.5904),
            'PARK HILLS': (37.8542, -90.5182),
            'LEADINGTON': (37.8278, -90.5093),
            'DESLOGE': (37.8714, -90.5271),
            'BONNE TERRE': (37.9231, -90.5551),
            'FLAT RIVER': (37.8508, -90.5229),
            'ELVINS': (37.8361, -90.5343),
            'ESTHER': (37.8356, -90.5454),
            'RIVERMINES': (37.8467, -90.5321),
            'DOE RUN': (37.7258, -90.5007),
            'FARMINGTON': (37.7806, -90.4218),
            'FREDERICKTOWN': (37.5598, -90.2940),
            'JUNCTION CITY': (37.5764, -90.2557),
            'MARQUAND': (37.4311, -90.1673),
            'SEDGEWICKVILLE': (37.5156, -89.9034),
            'PATTON': (37.5467, -89.9768),
            'PERRYVILLE': (37.7242, -89.8612),
            'FROHNA': (37.6403, -89.6195),
            'ALTENBURG': (37.6328, -89.5745),
            'GRAND TOWER': (37.6308, -89.5023),
            'WITTENBERG': (37.6481, -89.5323),
            'JACKSON': (37.3822, -89.6662),
            'OAK RIDGE': (37.5081, -89.7301),
            'FRIEDHEIM': (37.5525, -89.8245),
            'OLD APPLETON': (37.5906, -89.7084),
            'POCAHONTAS': (37.5050, -89.6439),
            'BURFORDVILLE': (37.3764, -89.8020),
            'MILLERSVILLE': (37.4303, -89.8003),
            'MARBLE HILL': (37.3061, -89.9703),
            'GLENALLEN': (37.3164, -90.0281),
            'GREENVILLE': (37.1272, -90.4498),
            'WILLIAMSVILLE': (36.9717, -90.5498),
            'PIEDMONT': (37.1542, -90.6962),
            'PATTERSON': (37.1978, -90.5454),
            'MILL SPRING': (37.0750, -90.6776),
            'ELLSINORE': (36.9328, -90.7468),
            'GRANDIN': (36.8256, -90.8237),
            'DONIPHAN': (36.6206, -90.8234),
            'FAIRDEALING': (36.6661, -90.6134),
            'OXLY': (36.5853, -90.6823),
            'NAYLOR': (36.5775, -90.6048),
            'NEELYVILLE': (36.5589, -90.5068),
            'POPLAR BLUFF': (36.7570, -90.3929),
            'HARVIELL': (36.6633, -90.4648),
            'FISK': (36.7833, -90.2084),
            'BROSELEY': (36.6867, -90.2434),
            'QULIN': (36.5959, -90.2501),
            'CAMPBELL': (36.4933, -90.0751),
            'HOLCOMB': (36.4003, -90.0254),
            'CLARKTON': (36.4512, -89.9659),
            'GIDEON': (36.4534, -89.9195),
            'RISCO': (36.5531, -89.8187),
            'PARMA': (36.6114, -89.8148),
            'CATRON': (37.1098, -89.7598),
            'BLOOMFIELD': (36.8859, -89.9292),
            'ADVANCE': (37.1045, -89.9098),
            'BELL CITY': (37.0209, -89.8176),
            'ORAN': (37.0850, -89.6551),
            'MORLEY': (37.0378, -89.6056),
            'BENTON': (37.0978, -89.5626),
            'COMMERCE': (37.1584, -89.4423),
            'SCOTT CITY': (37.2239, -89.5259),
            'KELSO': (37.1892, -89.5470),
            'CHAFFEE': (37.1800, -89.6551),
            'DELTA': (37.1972, -89.7376),
            'DUTCHTOWN': (37.2414, -89.6695),
            'GORDONVILLE': (37.3000, -89.6809),
            'WHITEWATER': (37.2369, -89.7437),
            'ALLENVILLE': (37.2178, -89.7787),
            'DAISY': (37.5392, -89.8284),
            'CROSSTOWN': (37.5656, -89.8740),
            'BRAZEAU': (37.6442, -89.8776),
            'UNIONTOWN': (37.8475, -89.8995),
            'FARRAR': (37.7156, -89.8437),
            'LONGTOWN': (37.7392, -89.7523),
            'SAINTE GENEVIEVE': (37.9814, -90.0418),
            'STE GENEVIEVE': (37.9814, -90.0418),
            'SAINT MARY': (37.8792, -89.9498),
            'CHESTER': (37.9136, -89.8223),
            'BLOOMSDALE': (38.0178, -90.2176),
            'FRENCH VILLAGE': (38.0889, -90.2076),
            'BONNE TERRE': (37.9231, -90.5551),
            'VALLES MINES': (38.0053, -90.4962),
            'TERRE DU LAC': (37.9056, -90.6287),
            'BLACKWELL': (38.0700, -90.6809),
            'CADET': (37.9772, -90.7443),
            'RICHWOODS': (38.1844, -90.8337),
            'DITTMER': (38.2911, -90.7329),
            'CEDAR HILL': (38.3508, -90.6404),
            'HILLSBORO': (38.2322, -90.5629),
            'DE SOTO': (38.1392, -90.5551),
            'MAPAVILLE': (38.2506, -90.4754),
            'HEMATITE': (38.2117, -90.4671),
            'MORSE MILL': (38.2553, -90.5329),
            'ROBERTSVILLE': (38.3919, -90.8098),
            'CATAWISSA': (38.3528, -90.7770),
            'LONEDELL': (38.4619, -90.8454),
            'LUEBBERING': (38.4544, -90.9132),
            'GRUBVILLE': (38.3972, -90.9993),
            'SAINT ALBANS': (38.5756, -90.7637),
            'VILLA RIDGE': (38.4744, -90.8868),
            'GRAY SUMMIT': (38.4883, -90.8165),
            'LABADIE': (38.5350, -90.8448),
            'PACIFIC': (38.4820, -90.7415),
            'EUREKA': (38.5025, -90.6279),
            'HIGH RIDGE': (38.4692, -90.5365),
            'HOUSE SPRINGS': (38.4086, -90.5548),
            'BYRNES MILL': (38.4333, -90.5809),
            'CEDAR HILL LAKES': (38.3592, -90.6429),
            'SCOTSDALE': (38.4753, -90.5693),
            'MURPHY': (38.4906, -90.4871),
            'IMPERIAL': (38.3697, -90.3779),
            'KIMMSWICK': (38.3650, -90.3637),
            'ARNOLD': (38.4328, -90.3776),
            'BARNHART': (38.3419, -90.4051),
            'PEVELY': (38.2833, -90.3951),
            'HERCULANEUM': (38.2614, -90.3804),
            'CRYSTAL CITY': (38.2211, -90.3790),
            'FESTUS': (38.2206, -90.3957),
            'TWIN OAKS': (38.5639, -90.4957),
            'VALLEY PARK': (38.5492, -90.4926),
            'FENTON': (38.5131, -90.4357),
            'HIGH RIDGE': (38.4692, -90.5365),
            'SUNSET HILLS': (38.5381, -90.4073),
            'CRESTWOOD': (38.5570, -90.3818),
            'SAPPINGTON': (38.5378, -90.3790),
            'CONCORD': (38.5242, -90.3576),
            'GRANTWOOD VILLAGE': (38.5503, -90.3507),
            'OAKLAND': (38.5778, -90.3785),
            'WARSON WOODS': (38.6067, -90.3854),
            'CRYSTAL LAKE PARK': (38.6031, -90.3493),
            'DES PERES': (38.6008, -90.4329),
            'KIRKWOOD': (38.5833, -90.4068),
            'WEBSTER GROVES': (38.5925, -90.3573),
            'ROCK HILL': (38.6075, -90.3726),
            'BRENTWOOD': (38.6170, -90.3490),
            'MAPLEWOOD': (38.6128, -90.3246),
            'SHREWSBURY': (38.5892, -90.3351),
            'AFFTON': (38.5506, -90.3335),
            'LEMAY': (38.5333, -90.2793),
            'MEHLVILLE': (38.5083, -90.3229),
            'OAKVILLE': (38.4700, -90.3048),
            'GREEN PARK': (38.5239, -90.3354),
            'BELLA VILLA': (38.5486, -90.2843),
            'SAINT GEORGE': (38.5353, -90.3179),
            'MACKENZIE': (38.5100, -90.3268),
            'WILBUR PARK': (38.5242, -90.3132),
            'MARLBOROUGH': (38.5717, -90.3246),
            'RICHMOND HEIGHTS': (38.6286, -90.3196),
            'CLAYTON': (38.6425, -90.3238),
            'UNIVERSITY CITY': (38.6556, -90.3098),
            'LADUE': (38.6370, -90.3801),
            'FRONTENAC': (38.6356, -90.4126),
            'TOWN AND COUNTRY': (38.6128, -90.4629),
            'CREVE COEUR': (38.6608, -90.4226),
            'OLIVETTE': (38.6653, -90.3768),
            'OVERLAND': (38.7014, -90.3624),
            'SAINT ANN': (38.7272, -90.3829),
            'MARYLAND HEIGHTS': (38.7131, -90.4298),
            'BRIDGETON': (38.7672, -90.4115),
            'HAZELWOOD': (38.7717, -90.3709),
            'FLORISSANT': (38.7892, -90.3226),
            'FERGUSON': (38.7442, -90.3054),
            'BERKELEY': (38.7547, -90.3312),
            'KINLOCH': (38.7408, -90.3237),
            'CALVERTON PARK': (38.7650, -90.3132),
            'DELLWOOD': (38.7489, -90.2854),
            'JENNINGS': (38.7200, -90.2604),
            'BELLEFONTAINE NEIGHBORS': (38.7408, -90.2270),
            'RIVERVIEW': (38.7478, -90.2090),
            'GLASGOW VILLAGE': (38.7547, -90.2001),
            'CASTLE POINT': (38.7514, -90.2437),
            'MOLINE ACRES': (38.7489, -90.2409),
            'BLACK JACK': (38.7933, -90.2676),
            'SPANISH LAKE': (38.7878, -90.2151),
            'NORTH COUNTY': (38.8000, -90.2500),
            'ALTON': (38.8906, -90.1843),
            'GODFREY': (38.9556, -90.1868),
            'BRIGHTON': (39.0392, -90.1412),
            'BETHALTO': (38.9078, -90.0387),
            'COTTAGE HILLS': (38.9028, -90.0815),
            'EAST ALTON': (38.8828, -90.1126),
            'WOOD RIVER': (38.8614, -90.0973),
            'HARTFORD': (38.8306, -90.0962),
            'ROXANA': (38.8486, -90.0762),
            'SOUTH ROXANA': (38.8281, -90.0640),
            'EDWARDSVILLE': (38.8114, -89.9532),
            'GLEN CARBON': (38.7483, -89.9832),
            'MARYVILLE': (38.7244, -89.9557),
            'TROY': (38.7294, -89.8834),
            'COLLINSVILLE': (38.6703, -89.9846),
            'CASEYVILLE': (38.6361, -90.0290),
            'FAIRVIEW HEIGHTS': (38.5889, -90.0051),
            'OFALLON': (38.8106, -89.9112),
            "O'FALLON": (38.8106, -89.9112),
            'SHILOH': (38.5600, -89.8993),
            'SWANSEA': (38.5339, -89.9890),
            'BELLEVILLE': (38.5201, -89.9840),
            'MILLSTADT': (38.4614, -90.0918),
            'SMITHTON': (38.4031, -90.0501),
            'FREEBURG': (38.4269, -89.9115),
            'MASCOUTAH': (38.4903, -89.7981),
            'NEW BADEN': (38.5347, -89.7001),
            'LEBANON': (38.6039, -89.8073),
            'SUMMERFIELD': (38.5950, -89.7454),
            'TRENTON': (38.6058, -89.6821),
            'AVISTON': (38.6072, -89.6073),
            'ALBERS': (38.5433, -89.6148),
            'GERMANTOWN': (38.5544, -89.5337),
            'BREESE': (38.6078, -89.5270),
            'BECKEMEYER': (38.6044, -89.4348),
            'CARLYLE': (38.6103, -89.3726),
            'HOFFMAN': (38.5472, -89.2648),
            'BARTELSO': (38.5344, -89.4662),
            'OKAWVILLE': (38.4339, -89.5509),
            'NASHVILLE': (38.3442, -89.3807),
            'ADDIEVILLE': (38.3903, -89.4901),
            'OAKDALE': (38.2631, -89.5015),
            'HOYLETON': (38.4417, -89.2726),
            'IRVINGTON': (38.4389, -89.1632),
            'RICHVIEW': (38.3758, -89.1801),
            'ASHLEY': (38.3297, -89.1873),
            'DU BOIS': (38.2253, -89.2145),
            'PINCKNEYVILLE': (38.0803, -89.3820),
            'TAMAROA': (38.1369, -89.2287),
            'DU QUOIN': (38.0117, -89.2362),
            'SAINT JOHNS': (38.0011, -89.2407),
            'ELKVILLE': (37.9106, -89.2334),
            'VERGENNES': (37.9019, -89.3417),
            'DOWELL': (37.9394, -89.2379),
            'ROYALTON': (37.8767, -89.1140),
            'ZEIGLER': (37.8994, -89.0523),
            'CHRISTOPHER': (37.9728, -89.0537),
            'BUCKNER': (37.9814, -89.0176),
            'MULKEYTOWN': (37.9714, -89.1109),
            'COELLO': (37.9931, -89.1262),
            'VALIER': (38.0147, -89.0454),
            'NORTH CITY': (37.9967, -89.0648),
            'SESSER': (38.0919, -89.0487),
            'WEST FRANKFORT': (37.8978, -88.9314),
            'ORIENT': (37.9167, -88.9884),
            'FREEMAN SPUR': (37.8578, -88.9873),
            'HERRIN': (37.8031, -89.0276),
            'ENERGY': (37.7747, -89.0281),
            'CARTERVILLE': (37.7600, -89.0773),
            'CRAINVILLE': (37.7514, -89.0676),
            'CAMBRIA': (37.7836, -89.1187),
            'CARBONDALE': (37.7273, -89.2168),
            'MAKANDA': (37.6178, -89.2106),
            'MURPHYSBORO': (37.7645, -89.3351),
            'DE SOTO': (37.8169, -89.2301),
            'HURST': (37.8369, -89.1398),
            'BUSH': (37.8456, -89.1323),
            'THOMPSONVILLE': (37.9169, -88.7634),
            'AKIN': (37.9808, -88.7551),
            'BENTON': (37.9967, -88.9201),
            'EWING': (38.0878, -88.8509),
            'MACEDONIA': (38.0550, -88.7051),
            'INA': (38.1511, -88.9062),
            'BONNIE': (38.2050, -88.9034),
            'NASON': (38.1742, -88.9673),
            'WALTONVILLE': (38.2092, -89.0387),
            'MOUNT VERNON': (38.3173, -88.9031),
            'OPDYKE': (38.2678, -88.7884),
            'BELLE RIVE': (38.2331, -88.7367),
            'DAHLGREN': (38.1978, -88.6851),
            'BLUFORD': (38.3381, -88.7298),
            'KELL': (38.4919, -88.9045),
            'TEXICO': (38.4347, -88.8951),
            'IUKA': (38.6153, -88.7784),
            'KINMUNDY': (38.7731, -88.8495),
            'ALMA': (38.7217, -88.9112),
            'PATOKA': (38.7508, -89.0998),
            'ODIN': (38.6172, -89.0523),
            'SANDOVAL': (38.6158, -89.1192),
            'CENTRAL CITY': (38.5486, -89.1276),
            'CENTRALIA': (38.5250, -89.1334),
            'WAMAC': (38.5094, -89.1423),
            'JUNCTION CITY': (38.5686, -88.9506),
            'SHATTUC': (38.5733, -89.0953),
            'BOULDER': (38.4942, -89.0428),
            'DARMSTADT': (38.5253, -89.9904),
            'SHAWNEETOWN': (37.7131, -88.1867),
            'OLD SHAWNEETOWN': (37.7003, -88.1369),
            'JUNCTION': (37.7306, -88.2367),
            'EQUALITY': (37.7339, -88.3442),
            'RIDGWAY': (37.8003, -88.2603),
            'OMAHA': (37.8917, -88.3025),
            'NEW HAVEN': (37.9189, -88.1289),
            'HERALD': (37.9536, -88.2326),
            'NORRIS CITY': (37.9811, -88.3292),
            'BROUGHTON': (37.9336, -88.4615),
            'GALATIA': (37.8433, -88.6098),
            'RALEIGH': (37.8264, -88.5414),
            'ELDORADO': (37.8136, -88.4381),
            'HARRISBURG': (37.7384, -88.5406),
            'MUDDY': (37.7539, -88.5228),
            'CARRIER MILLS': (37.6842, -88.6326),
            'STONEFORT': (37.6164, -88.7081),
            'CREAL SPRINGS': (37.6186, -88.8378),
            'NEW BURNSIDE': (37.5789, -88.7703),
            'OZARK': (37.5400, -88.7592),
            'TUNNEL HILL': (37.5147, -88.8470),
            'CYPRESS': (37.3650, -89.0167),
            'JUNCTURE': (37.3322, -89.0098),
            'BELKNAP': (37.3222, -88.9387),
            'KARNAK': (37.2931, -88.9759),
            'NEW GRAND CHAIN': (37.2522, -88.9823),
            'GRAND CHAIN': (37.2500, -89.0106),
            'OLMSTED': (37.1822, -89.0892),
            'ULLIN': (37.2761, -89.1834),
            'PULASKI': (37.2114, -89.2070),
            'MOUNDS CITY': (37.0853, -89.1628),
            'MOUNDS': (37.1144, -89.1978),
            'VILLA RIDGE': (37.1586, -89.1942),
            'MOUND CITY': (37.0853, -89.1628),
            'CACHE': (37.1892, -89.2039),
            'CAIRO': (37.0053, -89.1765),
            'TAMMS': (37.2358, -89.2698),
            'OLIVE BRANCH': (37.1681, -89.3506),
            'THEBES': (37.2206, -89.4595),
            'MCCLURE': (37.3197, -89.4337),
            'JONESBORO': (37.4517, -89.2681),
            'ANNA': (37.4603, -89.2470),
            'COBDEN': (37.5319, -89.2537),
            'ALTO PASS': (37.5689, -89.3181),
            'POMONA': (37.6267, -89.3359),
            'WOLF LAKE': (37.5028, -89.4398),
            'WARE': (37.4078, -89.4203),
            'JACOB': (37.4736, -89.5523),
            'GORHAM': (37.5553, -89.4845),
            'FOUNTAIN BLUFF': (37.5736, -89.5606),
            'GRAND TOWER': (37.6308, -89.5023),
            'ALDRIDGE': (37.5508, -89.7612),
            'ROCKWOOD': (37.5678, -89.6898),
            'MURDALE': (37.7106, -89.2448),
            'MARION': (37.7306, -88.9331),
            'PITTSBURG': (37.7747, -88.8476),
            'JOHNSTON CITY': (37.8206, -88.9276),
            'WHITEASH': (37.7892, -88.9226),
            'SPILLERTOWN': (37.7653, -88.9209),
            'COLP': (37.8031, -88.9562),
            'GRANITE CITY': (38.7014, -90.1487),
            'MADISON': (38.6856, -90.1593),
            'VENICE': (38.6728, -90.1698),
            'PONTOON BEACH': (38.7319, -90.0779),
            'MITCHELL': (38.7603, -90.0851),
            'NAMEOKI': (38.6958, -90.1337),
            'EAST CARONDELET': (38.5386, -90.2326),
            'DUPO': (38.5156, -90.2104),
            'CAHOKIA': (38.5708, -90.1901),
            'SAUGET': (38.5931, -90.1662),
            'NATIONAL CITY': (38.6681, -90.1151),
            'EAST SAINT LOUIS': (38.6245, -90.1507),
            'WASHINGTON PARK': (38.6353, -90.0934),
            'FAIRMONT CITY': (38.6500, -90.0934),
            'BROOKLYN': (38.6600, -90.1040),
            'LOVEJOY': (38.6567, -90.1579),
            'ALORTON': (38.5892, -90.1201),
            'CENTREVILLE': (38.5847, -90.1162),
            'MILLSTADT': (38.4614, -90.0918),
            'COLUMBIA': (38.4436, -90.2012),
            'WATERLOO': (38.3358, -90.1498),
            'VALMEYER': (38.3033, -90.2770),
            'MAEYSTOWN': (38.2283, -90.2326),
            'FULTS': (38.1636, -90.2151),
            'RENAULT': (38.1517, -90.1390),
            'PRAIRIE DU ROCHER': (38.0842, -90.0973),
            'MODOC': (38.0525, -90.0529),
            'ELLIS GROVE': (38.0092, -89.9062),
            'CHESTER': (37.9136, -89.8223),
            'PERCY': (38.0153, -89.8187),
            'CUTLER': (38.0286, -89.6595),
            'SPARTA': (38.1233, -89.7018),
            'WELGE': (38.1522, -89.5965),
            'EDEN': (38.2222, -89.7704),
            'TILDEN': (38.2100, -89.6823),
            'COULTERVILLE': (38.1858, -89.6040),
            'OAKWOOD': (38.2703, -89.5087),
            'SWANWICK': (38.2350, -89.4470),
            'NEW ATHENS': (38.3267, -89.8768),
            'LENZBURG': (38.2806, -89.8076),
            'MARISSA': (38.2500, -89.7504),
            'SAINT LIBORY': (38.3606, -89.7107),
            'VENEDY': (38.3881, -89.6609),
            'FAYETTEVILLE': (38.3792, -89.7965),
            'HECKER': (38.3050, -90.0357),
            'RED BUD': (38.2117, -89.9943),
            'BALDWIN': (38.1833, -89.8407),
            'EVANSVILLE': (38.0897, -89.9329),
            'KASKASKIA': (37.9214, -89.9134),
            'ROCKWOOD': (37.9928, -89.6901),
            'HOUSTON': (37.8300, -89.6612),
            'STEELEVILLE': (38.0072, -89.6590),
            'WALSH': (38.0586, -89.7829),
            'BLAIR': (38.0819, -89.8459),
            'PRAIRIE DU LONG': (38.0903, -89.9229),
            'MADONNAVILLE': (37.9883, -90.0562),
            'NEW OFFENBURG': (38.1611, -90.1040),
            'WARTBURG': (38.1783, -90.0584),
            'RENAULT STATION': (38.1525, -90.1201),
            'CHALFIN BRIDGE': (38.2839, -90.2757),
            'FOSTER POND': (38.3203, -90.2312),
            'MERRIMAC': (38.2500, -90.2437),
            'MONROE CITY': (39.6528, -91.7349),
            'PARIS': (39.6111, -91.9988),
            'SHELBINA': (39.6937, -92.0416),
            'LA PLATA': (40.0239, -92.4910),
            'EDINA': (40.1675, -92.1721),
            'KNOX CITY': (40.1408, -92.0088),
            'HURDLAND': (40.1522, -92.3021),
            'BRASHEAR': (40.1472, -92.3782),
            'GIBBS': (40.0989, -92.4238),
            'GREENTOP': (40.3447, -92.5691),
            'KIRKSVILLE': (40.1948, -92.5833),
            'NOVINGER': (40.2328, -92.7082),
            'NINEVEH': (40.3569, -92.6921),
            'WORTHINGTON': (40.4092, -92.7193),
            'GLENWOOD': (40.5122, -92.5727),
            'LANCASTER': (40.5208, -92.5288),
            'DOWNING': (40.4828, -92.3782),
            'QUEEN CITY': (40.4089, -92.5688),
            'COATSVILLE': (40.5247, -92.6399),
            'UNIONVILLE': (40.4764, -92.9941),
            'GREEN CITY': (40.2697, -92.9532),
            'GREEN CASTLE': (40.2767, -92.8649),
            'WINIGAN': (40.0456, -92.9066),
            'PURDIN': (39.9544, -93.1646),
            'BROWNING': (40.0311, -93.1493),
            'LACLEDE': (39.7850, -93.1688),
            'BROOKFIELD': (39.7845, -93.0733),
            'BUCKLIN': (39.8128, -92.8916),
            'NEW CAMBRIA': (39.7739, -92.7543),
            'CALLAO': (39.7467, -92.6288),
            'BEVIER': (39.7472, -92.5621),
            'EXCELLO': (39.6447, -92.4810),
            'JACKSONVILLE': (39.5906, -92.4671),
            'CAIRO': (39.5192, -92.4399),
            'HIGBEE': (39.3053, -92.5127),
            'CLARK': (39.2778, -92.3443),
            'STURGEON': (39.2342, -92.2810),
            'HALLSVILLE': (39.1161, -92.2249),
            'CENTRALIA': (39.2100, -92.1374),
            'HARRISBURG': (39.1442, -92.4654),
            'RUCKER': (39.1211, -92.5388),
            'THOMPSON': (39.2411, -92.5077),
            'RENICK': (39.3439, -92.3860),
            'ALLEN': (39.4261, -92.3216),
            'HIGBEE': (39.3053, -92.5127),
            'ARMSTRONG': (39.2653, -93.0938),
            'SALISBURY': (39.4217, -92.8016),
            'KEYTESVILLE': (39.4336, -92.9380),
            'DALTON': (39.3953, -92.9908),
            'BRUNSWICK': (39.4242, -93.1324),
            'MENDON': (39.5903, -93.1252),
            'SUMNER': (39.6544, -93.2438),
            'TRIPLETT': (39.4867, -93.1949),
            'CLIFTON HILL': (39.4600, -92.6638),
            'HUNTSVILLE': (39.4406, -92.5444),
            'THOMAS HILL': (39.5281, -92.7799),
            'MOBERLY': (39.4184, -92.4382),
            'MADISON': (39.4619, -92.2066),
            'HOLLIDAY': (39.5078, -92.1310),
            'PARIS': (39.4808, -91.9999),
            'GRANVILLE': (39.5264, -91.9899),
            'STOUTSVILLE': (39.5494, -91.8599),
            'FLORIDA': (39.4892, -91.7999),
            'SANTA FE': (39.3722, -91.8188),
            'PERRY': (39.4281, -91.6738),
            'CENTER': (39.5078, -91.5282),
            'NEW LONDON': (39.5850, -91.4010),
            'FRANKFORD': (39.4947, -91.3193),
            'CURRYVILLE': (39.3461, -91.3416),
            'VANDALIA': (39.3108, -91.4882),
            'FARBER': (39.2672, -91.5721),
            'LADDONIA': (39.2444, -91.6427),
            'RUSH HILL': (39.2069, -91.7232),
            'MEXICO': (39.1698, -91.8828),
            'AUXVASSE': (39.0150, -91.8977),
            'KINGDOM CITY': (38.9522, -91.9377),
            'CALWOOD': (38.9269, -92.0716),
            'WILLIAMSBURG': (38.9147, -91.7099),
            'PORTLAND': (38.7558, -91.7166),
            'STEEDMAN': (38.8083, -91.8232),
            'MOKANE': (38.6756, -91.8738),
            'CHAMOIS': (38.6736, -91.7710),
            'MORRISON': (38.6739, -91.6366),
            'GASCONADE': (38.6686, -91.5577),
            'HERMANN': (38.7042, -91.4371),
            'SWISS': (38.5997, -91.4454),
            'BAY': (38.5306, -91.4610),
            'MOUNT STERLING': (38.5136, -91.5893),
            'BERGER': (38.6706, -91.3371),
            'NEW FRANKLIN': (39.0161, -92.7377),
            'FRANKLIN': (39.0331, -92.8088),
            'BONNOTS MILL': (38.5503, -91.9627),
            'LOOSE CREEK': (38.4872, -91.9577),
            'LINN': (38.4861, -91.8488),
            'OSAGE CITY': (38.6361, -91.9610),
            'MINT HILL': (38.5003, -91.4949),
            'STOLPE': (38.4972, -91.3299),
            'RHINELAND': (38.7200, -91.5149),
            'AMERICUS': (38.6572, -91.3610),
            'BLUFFTON': (38.7322, -91.5466),
            'MCKIRTTRICK': (38.7572, -91.4399),
            'BIG SPRING': (38.5369, -91.0888),
            'WOOLDRIDGE': (39.0025, -92.9466),
            'ROCHEPORT': (38.9781, -92.5627),
            'JAMESTOWN': (38.7625, -92.4777),
            'PRAIRIE HOME': (38.8103, -92.5932),
            'PILOT GROVE': (38.8747, -92.9121),
            'NELSON': (38.9958, -93.0355),
            'BLACKWATER': (38.9783, -92.9777),
            'ARROW ROCK': (39.0700, -92.9477),
            'MIAMI': (39.3231, -93.2277),
            'DE WITT': (39.3864, -93.3044),
            'MALTA BEND': (39.1933, -93.3638),
            'GILLIAM': (39.2394, -93.0838),
            'SLATER': (39.2178, -93.0688),
            'SALINE CITY': (39.1236, -93.0599),
            'MOUNT LEONARD': (39.1278, -93.0016),
            'MARSHALL': (39.1231, -93.1969),
            'SWEET SPRINGS': (38.9639, -93.4149),
            'HOUSTONIA': (38.9000, -93.3488),
            'HUGHESVILLE': (38.8364, -93.2788),
            'LA MONTE': (38.7736, -93.4255),
            'KNOB NOSTER': (38.7667, -93.5588),
            'WHITEMAN AFB': (38.7303, -93.5478),
            'WARRENSBURG': (38.7628, -93.7360),
            'CENTERVIEW': (38.7453, -93.8444),
            'HOLDEN': (38.7142, -94.0033),
            'KINGSVILLE': (38.7522, -94.0694),
            'CHILHOWEE': (38.6172, -93.8560),
            'LEETON': (38.5836, -93.6955),
            'URICH': (38.4583, -94.0083),
            'ARCHIE': (38.4817, -94.3544),
            'ADRIAN': (38.3978, -94.3516),
            'AMSTERDAM': (38.3492, -94.5866),
            'DREXEL': (38.4756, -94.6055),
            'MERWIN': (38.4053, -94.5894),
            'CLEVELAND': (38.6883, -94.5911),
            'FREEMAN': (38.6239, -94.4988),
            'PECULIAR': (38.7192, -94.4580),
            'LOUISBURG': (38.6197, -94.6808),
            'PAOLA': (38.5722, -94.8797),
            'HILLSDALE': (38.6567, -94.8436),
            'LACYGNE': (38.3486, -94.7408),
            'FONTANA': (38.4122, -94.8447),
            'PARKER': (38.3300, -94.9908),
            'OSAWATOMIE': (38.4972, -94.9502),
            'RANTOUL': (38.5478, -95.1030),
            'LANE': (38.4392, -95.0824),
            'PRINCETON': (38.4856, -95.2683),
            'RICHMOND': (38.4028, -95.2547),
            'GARNETT': (38.2806, -95.2416),
            'GREELEY': (38.3631, -95.1219),
            'WESTPHALIA': (38.1847, -95.4936),
            'WELDA': (38.1631, -95.2958),
            'COLONY': (38.0714, -95.3644),
            'KINCAID': (38.0836, -95.1533),
            'LONE ELM': (38.0808, -94.9453),
            'BRONSON': (37.8972, -95.0733),
            'MORAN': (37.9161, -95.1703),
            'LA HARPE': (37.9189, -95.3011),
            'GAS': (37.9239, -95.3458),
            'IOLA': (37.9245, -95.3997),
            'HUMBOLDT': (37.8100, -95.4369),
            'PETROLIA': (37.7989, -95.3172),
            'CHANUTE': (37.6792, -95.4572),
            'EARLTON': (37.5839, -95.4708),
            'ERIE': (37.5675, -95.2436),
            'GALESBURG': (37.4733, -95.3558),
            'PARSONS': (37.3403, -95.2614),
            'MOUND VALLEY': (37.2072, -95.4072),
            'ALTAMONT': (37.1897, -95.2983),
            'EDNA': (37.0603, -95.3583),
            'BARTLETT': (37.0542, -95.2122),
            'CHETOPA': (37.0381, -94.9675),
            'OSWEGO': (37.1681, -95.1114),
            'COLUMBUS': (37.1689, -94.8442),
            'BAXTER SPRINGS': (37.0236, -94.7358),
            'TREECE': (37.0006, -94.8436),
            'PICHER': (36.9867, -94.8297),
            'QUAPAW': (36.9531, -94.7883),
            'COMMERCE': (36.9334, -94.8730),
            'MIAMI': (36.8745, -94.8775),
            'NORTH MIAMI': (36.9128, -94.8633),
            'WYANDOTTE': (36.7931, -94.7244),
            'FAIRLAND': (36.7514, -94.8472),
            'AFTON': (36.6973, -94.9636),
            'MONKEY ISLAND': (36.5978, -94.8761),
            'BERNICE': (36.6339, -95.0086),
            'GROVE': (36.5934, -94.7691),
            'JAY': (36.4209, -94.7977),
            'EUCHA': (36.3903, -94.9402),
            'COLCORD': (36.2645, -94.6916),
            'WEST SILOAM SPRINGS': (36.1878, -94.5716),
            'SILOAM SPRINGS': (36.1881, -94.5405),
            'GENTRY': (36.2676, -94.4847),
            'SPRINGTOWN': (36.2615, -94.4075),
            'DECATUR': (36.3359, -94.4602),
            'GRAVETTE': (36.3220, -94.4533),
            'CENTERTON': (36.3598, -94.2850),
            'HIGHFILL': (36.2620, -94.3475),
            'CAVE SPRINGS': (36.2867, -94.2319),
            'LOWELL': (36.2553, -94.1308),
            'ROGERS': (36.3320, -94.1185),
            'BENTONVILLE': (36.3729, -94.2088),
            'BELLA VISTA': (36.4806, -94.2719),
            'PEA RIDGE': (36.4539, -94.1152),
            'GARFIELD': (36.4462, -93.9738),
            'GATEWAY': (36.4856, -93.9380),
            'AVOCA': (36.3984, -94.0708),
            'BRIGHTWATER': (36.4184, -94.1580),
            'LITTLE FLOCK': (36.3859, -94.1355),
            'SPRINGDALE': (36.1867, -94.1288),
            'TONTITOWN': (36.1778, -94.2336),
            'JOHNSON': (36.1328, -94.1652),
            'FAYETTEVILLE': (36.0626, -94.1574),
            'PRAIRIE GROVE': (35.9759, -94.3177),
            'LINCOLN': (35.9495, -94.4233),
            'RHEA': (35.9123, -94.3386),
            'SUMMERS': (35.9181, -94.4883),
            'WESTVILLE': (35.9937, -94.5683),
            'WATTS': (36.1095, -94.5691),
            'CHRISTIE': (35.8809, -94.6855),
            'BARON': (35.9162, -94.5808),
            'PROCTOR': (35.9809, -94.7761),
            'TAHLEQUAH': (35.9154, -94.9699),
            'HULBERT': (35.9323, -95.1436),
            'PEGGS': (36.0748, -95.1025),
            'LOCUST GROVE': (36.2001, -95.1672),
            'PRYOR': (36.3084, -95.3169),
            'CHOUTEAU': (36.1856, -95.3447),
            'SPORTSMEN ACRES': (36.2867, -95.3647),
            'MAZIE': (36.1462, -95.3869),
            'SALINA': (36.2881, -95.1508),
            'SPAVINAW': (36.3884, -95.0491),
            'STRANG': (36.4106, -95.1350),
            'BIG CABIN': (36.5373, -95.2211),
            'PENSACOLA': (36.4334, -95.4527),
            'LANGLEY': (36.4701, -95.0502),
            'KETCHUM': (36.5259, -95.0258),
            'DISNEY': (36.4762, -94.9969),
            'CLEORA': (36.5284, -94.9727),
            'VINITA': (36.6387, -95.1533),
            'BLUEJACKET': (36.7998, -95.0736),
            'WELCH': (36.8750, -95.1033),
            'CENTRALIA': (36.7209, -95.3422),
            'PYRAMID CORNERS': (36.7406, -95.3950),
            'CHELSEA': (36.5356, -95.4325),
            'BUSHYHEAD': (36.4631, -95.4861),
            'FOYIL': (36.4359, -95.5158),
            'SEQUOYAH': (36.3684, -95.5836),
            'CLAREMORE': (36.3126, -95.6161),
            'VALLEY PARK': (36.2331, -95.6497),
            'VERDIGRIS': (36.2334, -95.6939),
            'CATOOSA': (36.1889, -95.7458),
            'FAIR OAKS': (36.2734, -95.7997),
            'NEW TULSA': (36.2981, -95.8083),
            'LIMESTONE': (36.2598, -95.8508),
            'OOLOGAH': (36.4476, -95.7083),
            'TALALA': (36.5373, -95.7994),
            'RAMONA': (36.5284, -95.9225),
            'OCHELATA': (36.5953, -96.0281),
            'BARTLESVILLE': (36.7473, -95.9808),
            'DEWEY': (36.7959, -95.9350),
            'COPAN': (36.8998, -95.9239),
            'WANN': (36.9156, -95.7908),
            'LENAPAH': (36.8520, -95.6364),
            'DELAWARE': (36.7759, -95.6386),
            'NOWATA': (36.7001, -95.6380),
            'NEW ALLUWE': (36.6484, -95.4908),
            'SOUTH COFFEYVILLE': (37.0011, -95.6236),
            'COFFEYVILLE': (37.0373, -95.6164),
            'LIBERTY': (37.1567, -95.5997),
            'INDEPENDENCE': (37.2245, -95.7083),
            'SYCAMORE': (37.3320, -95.7150),
            'CHERRYVALE': (37.2700, -95.5522),
            'DENNIS': (37.3422, -95.4125),
            'MOUND VALLEY': (37.2072, -95.4072),
            'BIG HILL': (37.1103, -95.4936),
            'SEDAN': (37.1267, -96.1861),
            'PERU': (37.0806, -96.0936),
            'CHAUTAUQUA': (37.0236, -96.1783),
            'ELGIN': (37.0011, -96.2836),
            'HAVANA': (37.0878, -95.9447),
            'TYRO': (37.0328, -95.7969),
            'CANEY': (37.0153, -95.9342),
            'NIOTAZE': (37.0656, -96.0136),
            'DEARING': (37.0578, -95.7086),
            'COPELAND': (37.1564, -95.6325),
            'WAUNETA': (36.9934, -96.0789),
            'DEWEZE': (36.9156, -95.9897),
            'BOWRING': (36.9131, -96.0319),
            'TALIHINA': (34.7512, -95.0480),
            'WHITESBORO': (34.6859, -95.0741),
            'ALBION': (34.6656, -95.0963),
            'KIOWA': (34.7273, -95.3036),
            'YANUSH': (34.8839, -95.3644),
            'CLAYTON': (34.5887, -95.3563),
            'TUSKAHOMA': (34.6131, -95.2727),
            'NASHOBA': (34.4970, -95.2283),
            'HONOBIA': (34.5487, -94.9191),
            'SMITHVILLE': (34.4612, -94.6297),
            'HATFIELD': (34.4851, -94.3780),
            'MENA': (34.5862, -94.2397),
            'MOUNTAIN FORK': (34.3973, -94.7397),
            'GRANNIS': (34.2403, -94.3366),
            'WICKES': (34.3037, -94.3364),
            'COVE': (34.4309, -94.3936),
            'VANDERVOORT': (34.3773, -94.3658),
            'GILLHAM': (34.1667, -94.3147),
            'DE QUEEN': (34.0376, -94.3411),
            'EAGLETOWN': (34.0342, -94.6214),
            'BROKEN BOW': (34.0293, -94.7391),
            'IDABEL': (33.8959, -94.8630),
            'HAWORTH': (33.8473, -94.6522),
            'MILLERTON': (33.9853, -95.0094),
            'VALLIANT': (34.0040, -95.0853),
            'RUFE': (34.1167, -95.1486),
            'SWINK': (34.0184, -95.2016),
            'FORT TOWSON': (34.0234, -95.2683),
            'RAYMOND': (34.1239, -95.5489),
            'SAWYER': (34.0301, -95.3775),
            'SPENCERVILLE': (34.0612, -95.4191),
            'NELSON': (34.0970, -95.4711),
            'FROGVILLE': (34.0137, -95.5397),
            'HUGO': (34.0107, -95.5097),
            'GRANT': (33.9401, -95.5164),
            'SOPER': (34.0301, -95.6956),
            'BOSWELL': (34.0287, -95.8694),
            'UNGER': (34.0542, -95.9528),
            'ANTLERS': (34.2312, -95.6203),
            'MOYERS': (34.3823, -95.6686),
            'KOSOMA': (34.3631, -95.3858),
            'CLOUDY': (34.3920, -95.4850),
            'DAISY': (34.5206, -95.7003),
            'STRINGTOWN': (34.4715, -96.0569),
            'BLANCO': (34.6348, -95.8219),
            'TALIHINA': (34.7512, -95.0480),
            'BENGAL': (34.7401, -95.1372),
            'SUMMERFIELD': (34.6887, -95.2405),
            'STANLEY': (34.5031, -95.5233),
            'GOWEN': (34.3337, -95.7197),
            'SNOW': (34.3631, -95.4219),
            'RATTAN': (34.1959, -95.4200),
            'DUNBAR': (34.2501, -95.3158),
            'RINGOLD': (34.1770, -95.1703),
            'WRIGHT CITY': (34.0612, -94.9797),
            'MILLERTON': (33.9853, -95.0094),
            'MANCHESTER': (34.6156, -95.5869),
            'DARWIN': (34.4498, -95.7800),
            'FINLEY': (34.3445, -95.8322),
            'PARIS': (33.6609, -95.5555),
            'POWDERLY': (33.7798, -95.5249),
            'FAUGHT': (33.8137, -95.5508),
            'BROOKSTON': (33.6245, -95.6777),
            'SUMNER': (33.7559, -95.7308),
            'CHICOTA': (33.8512, -95.7069),
            'COOPER': (33.3565, -95.6891),
            'ENLOE': (33.3537, -95.5919),
            'COMMERCE': (33.2471, -95.8994),
            'KLONDIKE': (33.3073, -96.0125),
            'LONE OAK': (32.9990, -95.9450),
            'CUMBY': (33.1348, -95.8497),
            'SULPHUR SPRINGS': (33.1384, -95.6011),
            'RIDGEWAY': (33.1570, -95.4572),
            'BIRTHRIGHT': (33.1012, -95.4236),
            'SULPHUR BLUFF': (33.3426, -95.3761),
            'DIKE': (33.2276, -95.4747),
            'MILLER GROVE': (33.1687, -95.3867),
            'NELTA': (33.1076, -95.3144),
            'TIRA': (33.3248, -95.5647),
            'COOPER LAKE': (33.3762, -95.6555),
            'PECAN GAP': (33.4412, -95.8480),
            'BEN FRANKLIN': (33.4573, -95.7497),
            'MONTALBA': (33.4898, -95.8836),
            'LAKE CREEK': (33.4026, -96.0344),
            'BONHAM': (33.5773, -96.1783),
            'DODD CITY': (33.5737, -95.9894),
            'WINDOM': (33.5656, -95.9089),
            'HONEY GROVE': (33.5834, -95.9086),
            'ROXTON': (33.5423, -95.7269),
            'PETTY': (33.5898, -95.8022),
            'LADONIA': (33.4262, -95.9494),
            'BAILEY': (33.4323, -96.1672),
            'ECTOR': (33.5801, -96.2739),
            'RAVENNA': (33.6737, -96.2450),
            'SAVOY': (33.5990, -96.3683),
            'BELLS': (33.6104, -96.4108),
            'WHITEWRIGHT': (33.5129, -96.3925),
            'TOM BEAN': (33.5201, -96.4839),
            'RANDOLPH': (33.4651, -96.2756),
            'TRENTON': (33.4306, -96.3422),
            'LEONARD': (33.3795, -96.2475),
            'WOLFE CITY': (33.3706, -96.0686),
            'CELESTE': (33.2934, -96.1986),
            'GREENVILLE': (33.1384, -96.1108),
            'COMMERCE': (33.2471, -95.8994),
            'CAMPBELL': (33.1476, -95.9508),
            'NEYLANDVILLE': (33.2012, -95.9697),
            'WEAVER': (33.2265, -95.7844),
            'CUMBY': (33.1348, -95.8497),
            'BRASHEAR': (33.1273, -95.7444),
            'COMO': (32.9979, -95.4719),
            'PICKTON': (32.9657, -95.4530),
            'SALTILLO': (32.9223, -95.3408),
            'MOUNT VERNON': (33.1768, -95.2233),
            'CYPRESS': (33.0126, -95.1086),
            'WINFIELD': (33.1662, -95.1097),
            'BRIDGES CHAPEL': (33.2812, -95.0914),
            'MOUNT PLEASANT': (33.1568, -94.9686),
            'OMAHA': (33.1801, -94.7486),
            'NAPLES': (33.2026, -94.6797),
            'SIMMS': (33.3148, -94.5900),
            'MARIETTA': (33.1701, -94.5436),
            'COOKVILLE': (33.2495, -94.8775),
            'TALCO': (33.3609, -95.0961),
            'BOGATA': (33.4718, -95.2144),
            'FULBRIGHT': (33.6304, -95.1683),
            'DEPORT': (33.5265, -95.3161),
            'MILTON': (33.6337, -95.4494),
            'DETROIT': (33.6612, -95.2650),
            'BAGWELL': (33.7765, -95.1572),
            'ANNONA': (33.5823, -94.9058),
            'AVERY': (33.5459, -94.7797),
            'CLARKSVILLE': (33.6106, -95.0530),
            'MANCHESTER': (33.5904, -95.0894),
            'MILTON': (33.6337, -95.4494),
            'WOODLAND': (33.6748, -95.2303),
            'KANAWHA': (33.6965, -95.3108),
            'ROSALIE': (33.7151, -95.4678),
            'BLOSSOM': (33.6615, -95.3858),
            'SYLVAN': (33.5401, -95.3969),
            'BLAKENEY': (33.4848, -95.4119),
            'RUGBY': (33.5326, -95.3578),
            'CLARDY': (33.6215, -95.4403),
            'RENO': (33.6654, -95.4644),
            'ARTHUR CITY': (33.8765, -95.5014),
            'POWDERLY': (33.7798, -95.5249),
            'CAVINESS': (33.9070, -95.4147),
            'ATLAS': (33.8456, -95.3869),
            'MAXEY': (33.8737, -95.3831),
            'BROOKSTON': (33.6245, -95.6777),
            'ROXTON': (33.5423, -95.7269),
            'TELEPHONE': (33.7815, -96.0158),
            'IVANHOE': (33.6690, -96.2544),
            'DIAL': (33.7104, -96.2475),
            'AMBROSE': (33.7587, -96.0886),
            'FOREST CHAPEL': (33.8034, -95.9111),
            'GLORY': (33.8501, -95.8361),
            'WHITEROCK': (33.8965, -95.9047),
            'SUN VALLEY': (33.8959, -95.8258),
            'HOWLAND': (33.9012, -95.7450),
            'TIGERTOWN': (33.8670, -95.9872),
            'NOBILITY': (33.9787, -95.8919),
            'RAZOR': (34.0098, -95.9111),
            'HIGH HILL': (34.0476, -95.8314),
            'FAULKNER': (34.0556, -95.7011),
            'DIRECT': (33.8787, -96.0158),
            'HOPEWELL': (33.9209, -96.0350),
            'SLATE SHOALS': (33.9701, -96.1153),
            'WARREN': (34.0212, -96.0528),
            'FALLON': (34.0670, -96.0325),
            'ALLISON': (34.0845, -95.9928),
            'GAY': (34.1034, -96.0597),
            'ELMORE': (34.0237, -96.1136),
            'SANDERS': (33.9562, -96.1353),
            'DUPLEX': (33.8726, -96.1486),
            'MULBERRY': (33.9101, -96.0669),
            'NASHVILLE': (36.9759, -86.4553)
        }
        
    def geocode_with_census(self, address: str) -> Tuple[Optional[float], Optional[float]]:
        """Geocode using US Census Geocoder API (free, no key required)"""
        try:
            # Census Geocoder API endpoint
            url = "https://geocoding.geo.census.gov/geocoder/locations/onelineaddress"
            
            params = {
                'address': address,
                'benchmark': 'Public_AR_Current',
                'format': 'json'
            }
            
            response = requests.get(url, params=params, timeout=10)
            
            if response.status_code == 200:
                data = response.json()
                
                # Check if we got results
                if data.get('result') and data['result'].get('addressMatches'):
                    match = data['result']['addressMatches'][0]
                    coords = match.get('coordinates')
                    if coords:
                        lon = coords.get('x')
                        lat = coords.get('y')
                        return lat, lon
                        
        except Exception as e:
            logger.debug(f"Census geocoding failed: {e}")
            
        return None, None
        
    def geocode_with_nominatim(self, address: str) -> Tuple[Optional[float], Optional[float]]:
        """Geocode using Nominatim (OpenStreetMap) API (free)"""
        try:
            # Nominatim API endpoint
            url = "https://nominatim.openstreetmap.org/search"
            
            params = {
                'q': address,
                'format': 'json',
                'limit': 1,
                'countrycodes': 'us'
            }
            
            headers = {
                'User-Agent': 'Missouri RHC Geocoder/1.0 (healthcare mapping project)'
            }
            
            response = requests.get(url, params=params, headers=headers, timeout=10)
            
            if response.status_code == 200:
                results = response.json()
                if results:
                    lat = float(results[0]['lat'])
                    lon = float(results[0]['lon'])
                    return lat, lon
                    
        except Exception as e:
            logger.debug(f"Nominatim geocoding failed: {e}")
            
        return None, None
        
    def geocode_rhc(self, row: pd.Series) -> Tuple[Optional[float], Optional[float], str]:
        """Geocode a single RHC using multiple methods"""
        
        # Build address
        address_parts = []
        if pd.notna(row.get('ADDRESS LINE 1')):
            address_parts.append(str(row['ADDRESS LINE 1']))
        if pd.notna(row.get('CITY')):
            address_parts.append(str(row['CITY']))
        address_parts.append('MO')
        if pd.notna(row.get('ZIP CODE')):
            address_parts.append(str(row['ZIP CODE'])[:5])
            
        full_address = ' '.join(address_parts)
        
        # Method 1: Try Census Geocoder first (most accurate for US)
        lat, lon = self.geocode_with_census(full_address)
        if lat and lon:
            self.stats['census_success'] += 1
            return lat, lon, 'census'
            
        # Method 2: Try Nominatim
        lat, lon = self.geocode_with_nominatim(full_address)
        if lat and lon:
            self.stats['nominatim_success'] += 1
            return lat, lon, 'nominatim'
            
        # Method 3: Fall back to city coordinates
        city = str(row.get('CITY', '')).upper()
        if city in self.city_coords:
            lat, lon = self.city_coords[city]
            # Add small random offset
            lat += np.random.uniform(-0.01, 0.01)
            lon += np.random.uniform(-0.01, 0.01)
            self.stats['city_fallback'] += 1
            return lat, lon, 'city_lookup'
            
        self.stats['failed'] += 1
        return None, None, 'failed'
        
    def geocode_all_rhcs(self):
        """Geocode all 316 Missouri RHCs"""
        
        # Load RHCs
        if not self.rhc_file.exists():
            logger.error(f"RHC file not found: {self.rhc_file}")
            return None
            
        self.rhcs = pd.read_csv(self.rhc_file)
        self.stats['total'] = len(self.rhcs)
        
        logger.info("="*60)
        logger.info("GEOCODING ALL 316 MISSOURI RHCs")
        logger.info("="*60)
        logger.info(f"Total RHCs to geocode: {self.stats['total']}")
        logger.info("Using free APIs: Census Geocoder and Nominatim")
        
        # Add geocoding columns
        self.rhcs['latitude'] = None
        self.rhcs['longitude'] = None
        self.rhcs['geocode_method'] = None
        self.rhcs['geocoded'] = False
        
        # Process each RHC
        for idx, row in self.rhcs.iterrows():
            if idx % 10 == 0:
                logger.info(f"Progress: {idx}/{self.stats['total']} RHCs processed...")
                
            lat, lon, method = self.geocode_rhc(row)
            
            if lat and lon:
                self.rhcs.at[idx, 'latitude'] = lat
                self.rhcs.at[idx, 'longitude'] = lon
                self.rhcs.at[idx, 'geocode_method'] = method
                self.rhcs.at[idx, 'geocoded'] = True
                
            # Rate limiting - be respectful of free APIs
            time.sleep(0.5)  # Half second between requests
            
        # Generate report
        self.generate_geocoding_report()
        
        # Save geocoded data
        timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
        output_file = self.output_dir / f"missouri_rhcs_geocoded_{timestamp}.csv"
        self.rhcs.to_csv(output_file, index=False)
        
        logger.info(f"\n Geocoded data saved to: {output_file}")
        
        return self.rhcs
        
    def generate_geocoding_report(self):
        """Generate geocoding summary report"""
        
        total = self.stats['total']
        geocoded = self.stats['census_success'] + self.stats['nominatim_success'] + self.stats['city_fallback']
        
        logger.info("\n" + "="*60)
        logger.info("GEOCODING RESULTS")
        logger.info("="*60)
        
        logger.info(f"\nTotal RHCs: {total}")
        logger.info(f"Successfully Geocoded: {geocoded} ({geocoded/total*100:.1f}%)")
        
        logger.info("\nGeocoding Methods Used:")
        logger.info(f"  Census Geocoder: {self.stats['census_success']} ({self.stats['census_success']/total*100:.1f}%)")
        logger.info(f"  Nominatim (OSM): {self.stats['nominatim_success']} ({self.stats['nominatim_success']/total*100:.1f}%)")
        logger.info(f"  City Lookup: {self.stats['city_fallback']} ({self.stats['city_fallback']/total*100:.1f}%)")
        logger.info(f"  Failed: {self.stats['failed']} ({self.stats['failed']/total*100:.1f}%)")
        
        # Save stats
        stats_file = self.output_dir / f"geocoding_stats_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json"
        with open(stats_file, 'w') as f:
            json.dump(self.stats, f, indent=2)
            
        logger.info(f"\nStats saved to: {stats_file}")
        

if __name__ == "__main__":
    geocoder = RHCGeocoder()
    geocoded_rhcs = geocoder.geocode_all_rhcs()
    
    if geocoded_rhcs is not None:
        print(f"\n Geocoding complete!")
        print(f"Successfully geocoded {geocoded_rhcs['geocoded'].sum()}/{len(geocoded_rhcs)} RHCs")
        print("\nNext steps:")
        print("1. Review geocoded data for accuracy")
        print("2. Update map with complete coordinates")
        print("3. Collect operational metrics from CMS APIs")